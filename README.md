# Qtim Тестовое задание Анкудинова

## ТЗ

- Написать CRUD для создания новостей
  Read - открыты для всех
  Create, Update, Delete - закрыты авторизацией
- Авторизация JWT
- Регистрация

Модель пользователя произвольная (email + password)
Модель новостей тоже произвольная
Использовать 1 jwt токен (access) в связке с refresh. И нужно время жизни для токенов - 3 минуты,
А время жизни refresh - 3 дня

## Что использовала

NestJS, Typescript, TypeOrm, PostgreSQL

## Роуты

### Авторизация

#### Регистрация

**POST**
**/api/v1/auth/signup**

Все поля обязательны, тело запроса:

```
{
    "email":"test@mail.com",
    "password": "abc123ABC!",
    "username": "abcde"
}
```

Ответ:

```
{
    "accessToken": "...",
    "refreshToken": "..."
}
```

#### Логин

**POST**
**/api/v1/auth/login**

Все поля обязательны, тело запроса:

```
{
    "email":"test@mail.com",
    "password": "abc123ABC!",
}
```

Ответ:

```
{
    "accessToken": "...",
    "refreshToken": "..."
}
```

#### Получение новых токенов

**GET**
**/api/v1/auth/refresh**

Доступен только при авторизации с refresh token

Ответ:

```
{
    "accessToken": "...",
    "refreshToken": "..."
}
```

#### Выход из аккаунта, сброс refresh токена

**GET**
**/api/v1/auth/logout**

Доступен только при авторизации с access token

Ответ: код 200 если все успешно

### СRUD Новостей

#### Добавление новости

**POST**
**/api/v1/article**

Доступен только с access token
Тело запроса:

```
{
  "title": "Новостной заголовок",
  "body": "Статья",
  "category": "Спорт" //Необязательное поле, по умолчанию ставится категория "Местные"
}
```

Ответ:

```
{
    "title": "Новостной заголовок",
    "body": "Статья",
    "category": "Спорт",
    "author": {
        "username": "testuser"
    },
    "id": 1,
    "created_at": "2023-11-15T17:29:25.606Z"
}
```

Автором статьи автоматически становится пользователь, который отправил запрос на создание

#### Просмотр новостей

**GET**
**/api/v1/article?limit=1&offset=0**

Параметры limit и offset необязательны, по умолчанию выставлены значения 10 и 0 соответственно
Ответ:

```
{
    "articles": [
      "title": "Новость 1",
      "body": "Описание новости 1",
      "category": "Спорт",
      "author": {
          "username": "anika"
      }
    ],
    "count": 1,
    "totalCount": 1
}
```

**GET**
**/api/v1/article/:id**

Ответ:

```
{
  "title": "Новость 1",
  "body": "Описание новости 1",
  "category": "Спорт",
  "author": {
      "username": "anika"
  }
}
```

#### Редактирование новостей

**PATCH**
**/api/v1/article/:id**

Доступен только с access token. Для изменения доступны только поля title, body и category
Тело запроса:

```
{
  "title": "Новый новостной заголовок",
}
```

Ответ: код 200 если все прошло успешно.

#### Удаление новостей

**DELETE**
**/api/v1/article/:id**

Доступен только с access token.
Ответ: код 200 если все прошло успешно.
